!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=78)}({0:function(t,e){t.exports=wp.i18n},1:function(t,e){t.exports=wp.components},10:function(t,e){t.exports=wp.url},11:function(t,e){t.exports=wp.blockEditor},14:function(t,e){t.exports=wp.richText},2:function(t,e){t.exports=wp.data},3:function(t,e){t.exports=lodash},30:function(t,e){t.exports=wp.htmlEntities},33:function(t,e){t.exports=wp.keycodes},5:function(t,e){t.exports=wp.element},52:function(t,e){t.exports=wp.dom},78:function(t,e,n){"use strict";n.r(e);var r=n(14),o=n(0),i=n(10),a=n(30),s=n(3),c=n(2),u=n(5),l=n(1),p=n(11),f=n(52),b=n(33);function d(t){if(t){var e=t.trim();if(e){if(/^\S+:/.test(e)){var n=Object(i.getProtocol)(e);if(!Object(i.isValidProtocol)(n))return;if(Object(s.startsWith)(n,"http")&&!/^https?:\/\/[^\/\s]/i.test(e))return;var r=Object(i.getAuthority)(e);if(!Object(i.isValidAuthority)(r))return;var o=Object(i.getPath)(e);if(o&&!Object(i.isValidPath)(o))return;var a=Object(i.getQueryString)(e);if(a&&!Object(i.isValidQueryString)(a))return;var c=Object(i.getFragment)(e);if(c&&!Object(i.isValidFragment)(c))return}if(!Object(s.startsWith)(e,"#")||Object(i.isValidFragment)(e))return 1}}}function h(t){var e=t.noFollow,n=t.sponsored,r=t.text,i={type:"rankmath/link",attributes:{url:t.url}},a=[];if(t.opensInNewWindow){var s=Object(o.sprintf)(Object(o.__)("%s (opens in a new tab)","rank-math"),r);i.attributes.target="_blank",i.attributes["aria-label"]=s,a.push("noreferrer noopener")}return e&&a.push("nofollow"),n&&a.push("sponsored"),0<a.length&&(i.attributes.rel=a.join(" ")),i}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(){return(k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function w(t){return t.stopPropagation()}function j(t,e){return t.addingLink||e.editLink}function S(t){var e=t.isActive,n=t.addingLink,r=t.value,o=function(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)~e.indexOf(n=i[r])||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)~e.indexOf(n=i[r])||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}(t,["isActive","addingLink","value"]),i=Object(u.useMemo)((function(){var t=window.getSelection();if(t.rangeCount){var e=t.getRangeAt(0);if(n)return Object(f.getRectangleFromRange)(e);var r=e.startContainer;for(r=r.nextElementSibling||r;r.nodeType!==window.Node.ELEMENT_NODE;)r=r.parentNode;var o=r.closest("a");return o?o.getBoundingClientRect():void 0}}),[e,n,r.start,r.end]);return i?wp.element.createElement(p.URLPopover,k({anchorRect:i},o)):null}var _=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(s,u.Component);var t,e,n,a=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r,o,i=g(t);if(e){var a=g(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return r=this,!(o=n)||"object"!==y(o)&&"function"!=typeof o?O(r):o}}(s);function s(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.apply(this,arguments)).editLink=t.editLink.bind(O(t)),t.submitLink=t.submitLink.bind(O(t)),t.onKeyDown=t.onKeyDown.bind(O(t)),t.onChangeInputValue=t.onChangeInputValue.bind(O(t)),t.setLinkTarget=t.setLinkTarget.bind(O(t)),t.setNoFollow=t.setNoFollow.bind(O(t)),t.setSponsored=t.setSponsored.bind(O(t)),t.onFocusOutside=t.onFocusOutside.bind(O(t)),t.resetState=t.resetState.bind(O(t)),t.autocompleteRef=Object(u.createRef)(),t.state={opensInNewWindow:!1,noFollow:!1,sponsored:!1,inputValue:""},t}return t=s,n=[{key:"getDerivedStateFromProps",value:function(t,e){var n=t.activeAttributes,r=n.url,o=n.rel,i="_blank"===n.target;if(j(t,e))return null;var a={};if(r!==e.inputValue&&(a.inputValue=r),i!==e.opensInNewWindow&&(a.opensInNewWindow=i),"string"==typeof o){var s=o.split(" ").includes("nofollow"),c=o.split(" ").includes("sponsored");s!==e.noFollow&&(a.noFollow=s),c!==e.sponsored&&(a.sponsored=c)}return Object.keys(a).length?a:null}}],(e=[{key:"onKeyDown",value:function(t){~[b.LEFT,b.DOWN,b.RIGHT,b.UP,b.BACKSPACE,b.ENTER].indexOf(t.keyCode)&&t.stopPropagation()}},{key:"onChangeInputValue",value:function(t){this.setState({inputValue:t})}},{key:"setLinkTarget",value:function(t){var e=this.props,n=e.activeAttributes.url,o=void 0===n?"":n,i=e.value,a=e.onChange;if(this.setState({opensInNewWindow:t}),!j(this.props,this.state)){var s=Object(r.getTextContent)(Object(r.slice)(i));a(Object(r.applyFormat)(i,h({url:o,opensInNewWindow:t,noFollow:this.state.noFollow,sponsored:this.state.sponsored,text:s})))}}},{key:"setNoFollow",value:function(t){var e=this.props,n=e.activeAttributes.url,o=void 0===n?"":n,i=e.value,a=e.onChange;if(this.setState({noFollow:t}),!j(this.props,this.state)){var s=Object(r.getTextContent)(Object(r.slice)(i));a(Object(r.applyFormat)(i,h({url:o,opensInNewWindow:this.state.opensInNewWindow,noFollow:t,sponsored:this.state.sponsored,text:s})))}}},{key:"setSponsored",value:function(t){var e=this.props,n=e.activeAttributes.url,o=void 0===n?"":n,i=e.value,a=e.onChange;if(this.setState({sponsored:t}),!j(this.props,this.state)){var s=Object(r.getTextContent)(Object(r.slice)(i));a(Object(r.applyFormat)(i,h({url:o,opensInNewWindow:this.state.opensInNewWindow,noFollow:this.state.noFollow,sponsored:t,text:s})))}}},{key:"editLink",value:function(t){this.setState({editLink:!0}),t.preventDefault()}},{key:"submitLink",value:function(t){var e=this.props,n=e.isActive,a=e.value,s=e.onChange,c=e.speak,u=this.state,l=u.inputValue,p=u.opensInNewWindow,f=u.noFollow,b=u.sponsored,y=Object(i.prependHTTP)(l),m=h({url:y,opensInNewWindow:p,noFollow:f,sponsored:b,text:Object(r.getTextContent)(Object(r.slice)(a))});if(t.preventDefault(),Object(r.isCollapsed)(a)&&!n){var v=Object(r.applyFormat)(Object(r.create)({text:y}),m,0,y.length);s(Object(r.insert)(a,v))}else s(Object(r.applyFormat)(a,m));this.resetState(),d(y)?c(Object(o.__)(n?"Link edited.":"Link inserted.","rank-math"),"assertive"):c(Object(o.__)("Warning: the link has been inserted but may have errors. Please test it.","rank-math"),"assertive")}},{key:"onFocusOutside",value:function(){var t=this.autocompleteRef.current;t&&t.contains(document.activeElement)||this.resetState()}},{key:"resetState",value:function(){this.props.stopAddingLink(),this.setState({editLink:!1})}},{key:"render",value:function(){var t=this,e=this.props,n=e.isActive,r=e.activeAttributes.url,a=e.addingLink;if(!n&&!a)return null;var s=this.state,c=s.opensInNewWindow,f=s.noFollow,b=s.sponsored,h=j(this.props,this.state);return wp.element.createElement(S,{value:e.value,isActive:n,addingLink:a,onFocusOutside:this.onFocusOutside,onClose:this.resetState,focusOnMount:!!h&&"firstElement",renderSettings:function(){return wp.element.createElement(u.Fragment,null,wp.element.createElement(l.ToggleControl,{label:Object(o.__)("Open in New Tab","rank-math"),checked:c,onChange:t.setLinkTarget}),wp.element.createElement(l.ToggleControl,{label:Object(o.__)("Nofollow","rank-math"),checked:f,onChange:t.setNoFollow}),wp.element.createElement(l.ToggleControl,{label:Object(o.__)("Sponsored","rank-math"),checked:b,onChange:t.setSponsored}))}},h?wp.element.createElement(p.URLPopover.LinkEditor,{className:"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content",value:s.inputValue,onChangeInputValue:this.onChangeInputValue,onKeyDown:this.onKeyDown,onKeyPress:w,onSubmit:this.submitLink,autocompleteRef:this.autocompleteRef}):wp.element.createElement(p.URLPopover.LinkViewer,{className:"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content",onKeyPress:w,url:r,onEditLinkClick:this.editLink,linkClassName:d(Object(i.prependHTTP)(r))?void 0:"has-invalid-link"}))}}])&&m(t.prototype,e),n&&m(t,n),s}(),L=Object(l.withSpokenMessages)(_);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var N="rankmath/link",I=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,u.Component);var t,e,n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r,o,i=A(t);if(e){var a=A(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return r=this,!(o=n)||"object"!==F(o)&&"function"!=typeof o?R(r):o}}(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.apply(this,arguments)).state={addingLink:!1},t.addLink=t.addLink.bind(R(t)),t.stopAddingLink=t.stopAddingLink.bind(R(t)),t.onRemoveFormat=t.onRemoveFormat.bind(R(t)),t}return t=a,(e=[{key:"componentDidMount",value:function(){var t=(0,Object(c.select)("core/rich-text").getFormatType)("core/link");t&&(t.edit=null,Object(c.dispatch)("core/rich-text").addFormatTypes(t))}},{key:"addLink",value:function(){var t=this.props,e=t.value,n=t.onChange,o=Object(r.getTextContent)(Object(r.slice)(e));o&&Object(i.isURL)(o)?n(Object(r.applyFormat)(e,{type:N,attributes:{url:o}})):o&&Object(i.isEmail)(o)?n(Object(r.applyFormat)(e,{type:N,attributes:{url:"mailto:".concat(o)}})):this.setState({addingLink:!0})}},{key:"stopAddingLink",value:function(){this.setState({addingLink:!1})}},{key:"onRemoveFormat",value:function(){var t=this.props,e=t.onChange,n=t.speak,i=t.value;Object(s.map)(["core/link","rankmath/link"],(function(t){i=Object(r.removeFormat)(i,t)})),e(x({},i)),n(Object(o.__)("Link removed.","rank-math"),"assertive")}},{key:"render",value:function(){var t=this.props,e=t.activeAttributes,n=t.onChange,i=this.props,a=i.isActive,c=i.value,l=Object(r.getActiveFormat)(c,"core/link");if(l){var f=Object(s.get)(l,"unregisteredAttributes.rel",!1);l.type=N,f&&(l.attributes=Object.assign(l.attributes,{rel:f})),Object(s.isUndefined)(l.unregisteredAttributes)||(l.unregisteredAttributes.class="");var b=c;b=Object(r.applyFormat)(b,l),n(x({},b=Object(r.removeFormat)(b,"core/link"))),c=b,a=!0}return wp.element.createElement(u.Fragment,null,wp.element.createElement(p.RichTextShortcut,{type:"primary",character:"k",onUse:this.addLink}),wp.element.createElement(p.RichTextShortcut,{type:"primaryShift",character:"k",onUse:this.onRemoveFormat}),a&&wp.element.createElement(p.RichTextToolbarButton,{name:"link",icon:"editor-unlink",title:Object(o.__)("Unlink","rank-math"),onClick:this.onRemoveFormat,isActive:a,shortcutType:"primaryShift",shortcutCharacter:"k"}),!a&&wp.element.createElement(p.RichTextToolbarButton,{name:"link",icon:"admin-links",title:Object(o.__)("Add Link","rank-math"),onClick:this.addLink,isActive:a,shortcutType:"primary",shortcutCharacter:"k"}),wp.element.createElement(L,{addingLink:this.state.addingLink,stopAddingLink:this.stopAddingLink,isActive:a,activeAttributes:e,value:c,onChange:n}))}}])&&E(t.prototype,e),a}(),D=Object(l.withSpokenMessages)(I),V={name:"rankmath/link",title:Object(o.__)("Link","rank-math"),tagName:"a",className:"rank-math-link",attributes:{url:"href",target:"target",rel:"rel"},__unstablePasteRule:function(t,e){var n=e.html,o=e.plainText;if(Object(r.isCollapsed)(t))return t;var s=(n||o).replace(/<[^>]+>/g,"").trim();return Object(i.isURL)(s)?Object(r.applyFormat)(t,{type:"rankmath/link",attributes:{url:Object(a.decodeEntities)(s)}}):t},edit:D};wp.domReady((function(){[V].forEach((function(t){var e=t.name,n=function(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)~e.indexOf(n=i[r])||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)~e.indexOf(n=i[r])||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}(t,["name"]);e&&Object(r.registerFormatType)(e,n)}))}))}});